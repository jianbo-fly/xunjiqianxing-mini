<view class="page-member">
  <!-- 头部用户信息 -->
  <view class="header" style="background-image: url('{{assets.bg.memberHeader}}');">
    <view class="user-info" bindtap="handleAvatarTap">
      <image
        class="avatar"
        src="{{userInfo.avatar || assets.placeholder.avatar}}"
        mode="aspectFill"
      />
      <view class="user-detail">
        <text class="nickname">{{isLogin ? (userInfo.nickname || '用户') : '点击登录'}}</text>
        <text wx:if="{{isLogin && userInfo.phone}}" class="phone">{{userInfo.phone}}</text>
      </view>
      <view class="arrow">›</view>
    </view>
  </view>

  <!-- 订单入口 -->
  <view class="order-section">
    <view class="section-header">
      <text class="section-title">我的订单</text>
      <view class="section-more" data-status="" bindtap="handleOrderTap">
        <text>全部订单</text>
        <text class="arrow">›</text>
      </view>
    </view>
    <view class="order-tabs">
      <view class="order-tab" data-status="0" bindtap="handleOrderTap">
        <image class="order-tab-icon" src="/assets/icons/order/status-pending.png" mode="aspectFit" />
        <text class="order-tab-text">待支付</text>
      </view>
      <view class="order-tab" data-status="1" bindtap="handleOrderTap">
        <image class="order-tab-icon" src="/assets/icons/order/status-confirmed.png" mode="aspectFit" />
        <text class="order-tab-text">待确认</text>
      </view>
      <view class="order-tab" data-status="2" bindtap="handleOrderTap">
        <image class="order-tab-icon" src="/assets/icons/order/status-travelling.png" mode="aspectFit" />
        <text class="order-tab-text">待出行</text>
      </view>
      <view class="order-tab" data-status="4" bindtap="handleOrderTap">
        <image class="order-tab-icon" src="/assets/icons/order/status-completed.png" mode="aspectFit" />
        <text class="order-tab-text">已完成</text>
      </view>
    </view>
  </view>

  <!-- 我的资产 -->
  <view class="assets-section" wx:if="{{isLogin}}">
    <view class="section-header">
      <text class="section-title">我的资产</text>
    </view>
    <view class="assets-grid">
      <view class="assets-item" bindtap="handlePointsTap">
        <text class="assets-value">{{userInfo.points || 0}}</text>
        <text class="assets-label">积分</text>
      </view>
      <view class="assets-divider"></view>
      <view class="assets-item" bindtap="handleCouponTap">
        <text class="assets-value">{{userInfo.couponCount || 0}}<text class="assets-unit">张</text></text>
        <text class="assets-label">优惠券</text>
      </view>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="menu-section">
    <view class="menu-item" bindtap="handleMemberTap">
      <image class="menu-icon" src="/assets/icons/common/crown.png" mode="aspectFit" />
      <text class="menu-title">{{userInfo.isMember ? '我的会员' : '开通会员'}}</text>
      <text class="menu-arrow">›</text>
    </view>
    <view
      class="menu-item"
      wx:for="{{menuList}}"
      wx:key="path"
      data-path="{{item.path}}"
      bindtap="handleMenuTap"
    >
      <image class="menu-icon" src="{{item.icon}}" mode="aspectFit" />
      <text class="menu-title">{{item.title}}</text>
      <text class="menu-arrow">›</text>
    </view>
  </view>

  <!-- 推广员入口 -->
  <view wx:if="{{features.promoter.enabled}}" class="menu-section">
    <view class="menu-item" bindtap="handlePromoterTap">
      <image class="menu-icon" src="/assets/icons/common/share.png" mode="aspectFit" />
      <text class="menu-title">{{userInfo.isPromoter ? '推广中心' : '成为推广员'}}</text>
      <text class="menu-arrow">›</text>
    </view>
  </view>

  <!-- 设置和客服 -->
  <view class="menu-section">
    <button class="menu-item menu-btn" open-type="contact" bindtap="handleServiceTap">
      <image class="menu-icon" src="/assets/icons/common/service.png" mode="aspectFit" />
      <text class="menu-title">联系客服</text>
      <text class="menu-arrow">›</text>
    </button>
    <view class="menu-item" bindtap="handleSettingsTap">
      <image class="menu-icon" src="/assets/icons/common/more.png" mode="aspectFit" />
      <text class="menu-title">设置</text>
      <text class="menu-arrow">›</text>
    </view>
  </view>

  <!-- 退出登录 -->
  <view wx:if="{{isLogin}}" class="logout-section">
    <button class="logout-btn" bindtap="handleLogout">退出登录</button>
  </view>
</view>
