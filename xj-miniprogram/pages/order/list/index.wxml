<!--
  订单列表页
-->
<view class="page-order-list">
  <!-- Tab栏 -->
  <view class="tab-bar">
    <view
      class="tab-item {{currentStatus === item.status ? 'active' : ''}}"
      wx:for="{{tabs}}"
      wx:key="status"
      data-status="{{item.status}}"
      bindtap="handleTabChange"
    >
      <text>{{item.label}}</text>
    </view>
  </view>

  <!-- 加载中 -->
  <view class="loading-container" wx:if="{{loading}}">
    <xj-loading text="加载中..." vertical />
  </view>

  <!-- 空状态 -->
  <xj-empty wx:elif="{{isEmpty}}" type="order">
    <view class="empty-btn" bindtap="goExplore">去逛逛</view>
  </xj-empty>

  <!-- 订单列表 -->
  <view class="order-list" wx:else>
    <view
      class="order-card"
      wx:for="{{list}}"
      wx:key="id"
    >
      <!-- 订单头部 -->
      <view class="order-header" data-id="{{item.id}}" bindtap="handleOrderTap">
        <view class="order-no">订单号: {{item.orderNo}}</view>
        <view class="order-status status-{{item.status}}">{{item.statusText}}</view>
      </view>

      <!-- 订单内容 -->
      <view class="order-content" data-id="{{item.id}}" bindtap="handleOrderTap">
        <image class="product-image" src="{{item.productImage}}" mode="aspectFill"></image>
        <view class="product-info">
          <view class="product-name">{{item.productName}}</view>
          <view class="product-sku">{{item.skuName}}</view>
          <view class="product-meta">
            <text class="meta-date">{{item.startDateText}}出发</text>
            <text class="meta-people">{{item.peopleText}}</text>
          </view>
        </view>
      </view>

      <!-- 订单底部 -->
      <view class="order-footer">
        <view class="order-amount">
          <text class="amount-label">实付</text>
          <text class="amount-value">¥{{item.payAmountText}}</text>
        </view>
        <view class="order-actions">
          <!-- 再次购买 -->
          <view
            class="action-btn btn-default"
            wx:if="{{item.showBuyAgainBtn}}"
            data-product-id="{{item.productId}}"
            catchtap="handleBuyAgain"
          >再次购买</view>
          <!-- 申请退款 -->
          <view
            class="action-btn btn-default"
            wx:if="{{item.showRefundBtn}}"
            data-id="{{item.id}}"
            catchtap="handleRefund"
          >申请退款</view>
          <!-- 取消订单 -->
          <view
            class="action-btn btn-default"
            wx:if="{{item.showCancelBtn}}"
            data-id="{{item.id}}"
            catchtap="handleCancel"
          >取消订单</view>
          <!-- 去支付 -->
          <view
            class="action-btn btn-primary"
            wx:if="{{item.showPayBtn}}"
            data-id="{{item.id}}"
            catchtap="handlePay"
          >去支付</view>
        </view>
      </view>
    </view>

    <!-- 加载更多 -->
    <view class="load-more" wx:if="{{loadingMore}}">
      <xj-loading size="sm" text="加载中..." />
    </view>

    <!-- 没有更多 -->
    <view class="no-more" wx:if="{{!hasMore && list.length > 0}}">
      <text>- 没有更多了 -</text>
    </view>
  </view>
</view>
