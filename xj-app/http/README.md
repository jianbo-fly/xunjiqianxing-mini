# å¯»è¿¹åƒè¡Œ API æµ‹è¯•æŒ‡å—

## ğŸ“‹ æµ‹è¯•æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | ç”¨é€” | ä½¿ç”¨å·¥å…· |
|------|------|---------|
| `api-test.http` | HTTP æµ‹è¯•ç”¨ä¾‹ | IDEA / VS Code REST Client |
| `xunjiqianxing-api.postman_collection.json` | Postman æµ‹è¯•é›†åˆ | Postman / Newman |

---

## ğŸš€ æ–¹å¼ä¸€ï¼šKnife4j åœ¨çº¿æµ‹è¯•

### 1. å¯åŠ¨æœåŠ¡

```bash
cd xunjiqianxing
mvn spring-boot:run -pl xj-app -Dspring-boot.run.profiles=dev
```

### 2. è®¿é—® Knife4j æ–‡æ¡£

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š**http://localhost:8080/doc.html**

### 3. åœ¨ Knife4j ä¸­æµ‹è¯•

1. å·¦ä¾§é€‰æ‹©æ¥å£åˆ†ç±»ï¼ˆå¦‚"é¦–é¡µæ¥å£"ï¼‰
2. ç‚¹å‡»å…·ä½“æ¥å£ï¼ˆå¦‚"è·å–é¦–é¡µæ•°æ®"ï¼‰
3. ç‚¹å‡» **"è°ƒè¯•"** æ ‡ç­¾
4. å¡«å…¥æµ‹è¯•å‚æ•°ï¼ˆå‚è€ƒä¸‹æ–¹æµ‹è¯•æ•°æ®ï¼‰
5. ç‚¹å‡» **"å‘é€"** æŒ‰é’®

### 4. è®¤è¯è®¾ç½®

éœ€è¦ç™»å½•çš„æ¥å£ï¼Œå…ˆæ‰§è¡Œç™»å½•è·å– tokenï¼Œç„¶ååœ¨ Knife4j çš„ **"æ–‡æ¡£ç®¡ç†" â†’ "å…¨å±€å‚æ•°è®¾ç½®"** ä¸­ï¼š

- å‚æ•°åï¼š`satoken`
- å‚æ•°å€¼ï¼šç™»å½•è¿”å›çš„ token
- å‚æ•°ä½ç½®ï¼š`header`

---

## ğŸ§ª æ–¹å¼äºŒï¼šHTTP æ–‡ä»¶æµ‹è¯•ï¼ˆæ¨èï¼‰

### åœ¨ IDEA ä¸­ä½¿ç”¨

1. æ‰“å¼€ `api-test.http` æ–‡ä»¶
2. ç‚¹å‡»æ¯ä¸ªè¯·æ±‚å·¦ä¾§çš„ â–¶ï¸ è¿è¡ŒæŒ‰é’®
3. ç™»å½•æ¥å£ä¼šè‡ªåŠ¨ä¿å­˜ token ä¾›åç»­è¯·æ±‚ä½¿ç”¨

### åœ¨ VS Code ä¸­ä½¿ç”¨

1. å®‰è£… **REST Client** æ‰©å±•
2. æ‰“å¼€ `api-test.http` æ–‡ä»¶
3. ç‚¹å‡» `Send Request` æ‰§è¡Œè¯·æ±‚

---

## ğŸ“¦ æ–¹å¼ä¸‰ï¼šPostman æµ‹è¯•

### å¯¼å…¥é›†åˆ

1. æ‰“å¼€ Postman
2. File â†’ Import
3. é€‰æ‹© `xunjiqianxing-api.postman_collection.json`

### è®¾ç½®ç¯å¢ƒå˜é‡

åœ¨ Postman ä¸­è®¾ç½®ä»¥ä¸‹å˜é‡ï¼š
- `baseUrl`: `http://localhost:8080`
- `token`: ç™»å½•åè‡ªåŠ¨ä¿å­˜

### æ‰¹é‡è¿è¡Œ

1. å³é”®ç‚¹å‡»é›†åˆ â†’ Run collection
2. é€‰æ‹©è¦æµ‹è¯•çš„æ¥å£
3. ç‚¹å‡» Run

### Newman å‘½ä»¤è¡Œè¿è¡Œ

```bash
# å®‰è£… Newman
npm install -g newman

# è¿è¡Œæµ‹è¯•
newman run xunjiqianxing-api.postman_collection.json
```

---

## ğŸ“ æµ‹è¯•æ•°æ®å‚è€ƒ

### ç”¨æˆ·ç™»å½•
```json
{
  "code": "081XDG000YlFfS1NPA300vtpih1XDG0t"
}
```

### åˆ›å»ºè®¢å•
```json
{
  "skuId": 2001,
  "startDate": "2026-02-15",
  "adultCount": 2,
  "childCount": 1,
  "contactName": "å¼ ä¸‰",
  "contactPhone": "13812345678",
  "travelers": [
    {
      "name": "å¼ ä¸‰",
      "idCard": "510123199001011234",
      "phone": "13812345678",
      "travelerType": 1
    }
  ]
}
```

### æäº¤å®šåˆ¶éœ€æ±‚
```json
{
  "phone": "13812345678",
  "destination": "äº‘å—å¤§ç†ã€ä¸½æ±Ÿ",
  "travelDateStart": "2026-03-01",
  "travelDateEnd": "2026-03-07",
  "adultCount": 4,
  "childCount": 2,
  "budget": "8000-15000"
}
```

### æ·»åŠ å‡ºè¡Œäºº
```json
{
  "name": "ç‹äº”",
  "idType": 1,
  "idNo": "510123199503032345",
  "phone": "13712345678",
  "gender": 1,
  "birthday": "1995-03-03",
  "isDefault": false
}
```

### ç”³è¯·æç°
```json
{
  "amount": 500.00,
  "withdrawType": 1,
  "account": "oXJQianXing123456",
  "accountName": "å¼ ä¸‰"
}
```

---

## ğŸ”§ æ¥å£çŠ¶æ€ç è¯´æ˜

| code | è¯´æ˜ |
|------|------|
| 200 | æˆåŠŸ |
| 400 | å‚æ•°é”™è¯¯ |
| 401 | æœªç™»å½• |
| 403 | æ— æƒé™ |
| 500 | ç³»ç»Ÿé”™è¯¯ |

---

## ğŸ“Œ æ³¨æ„äº‹é¡¹

1. **æµ‹è¯•å‰ç¡®ä¿æœåŠ¡å·²å¯åŠ¨**
2. **éœ€è¦ç™»å½•çš„æ¥å£å¿…é¡»å…ˆè·å– token**
3. **å¾®ä¿¡ç™»å½•åœ¨æµ‹è¯•ç¯å¢ƒéœ€è¦ Mock æˆ–ä½¿ç”¨çœŸå® code**
4. **æ•°æ®åº“éœ€è¦æœ‰æµ‹è¯•æ•°æ®æ‰èƒ½æ­£å¸¸è¿”å›ç»“æœ**
